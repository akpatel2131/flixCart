{"ast":null,"code":"import{LockOutlined,UserOutlined}from\"@ant-design/icons\";import{Button,Input,message}from\"antd\";import React,{useState}from\"react\";import{useHistory}from\"react-router-dom\";import{config}from\"../App\";import Footer from\"./Footer\";import Header from\"./Header\";const Login=()=>{const history=useHistory();const[loading,setLoading]=useState(false);const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const validateInput=()=>{if(!email){message.error(\"Email is a required field\");return false;}if(!password){message.error(\"Password is a required field\");return false;}return true;};const validateResponse=(errored,response)=>{if(errored||!response.tokens&&!response.message){message.error(\"Something went wrong. Check that the backend is running, reachable and returns valid JSON.\");return false;}if(!response.tokens){message.error(response.message);return false;}return true;};const performAPICall=async()=>{let response={};let errored=false;setLoading(true);try{response=await(await fetch(\"\".concat(config.endpoint,\"/auth/login\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({email,password})})).json();}catch(e){errored=true;}setLoading(false);if(validateResponse(errored,response)){return response;}};const persistLogin=(token,email,balance,name,userId)=>{localStorage.setItem(\"token\",token);localStorage.setItem(\"email\",email);localStorage.setItem(\"balance\",balance);localStorage.setItem(\"username\",name);localStorage.setItem(\"userId\",userId);localStorage.setItem(\"cartAmount\",null);};const login=async()=>{if(validateInput()){const response=await performAPICall();if(response){persistLogin(response.tokens.access.token,response.user.email,response.user.walletMoney,response.user.name,response.user._id);setEmail(\"\");setPassword(\"\");message.success(\"Logged in successfully\");history.push(\"/products\");}}};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Header,{history:history}),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"login-container container\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Login to FlixCart\"),/*#__PURE__*/React.createElement(Input,{className:\"input-field\",prefix:/*#__PURE__*/React.createElement(UserOutlined,{className:\"site-form-item-icon\"}),placeholder:\"email\",value:email,onChange:e=>setEmail(e.target.value)}),/*#__PURE__*/React.createElement(Input.Password,{className:\"input-field\",prefix:/*#__PURE__*/React.createElement(LockOutlined,{className:\"site-form-item-icon\"}),placeholder:\"Password\",value:password,onChange:e=>setPassword(e.target.value)}),/*#__PURE__*/React.createElement(Button,{loading:loading,type:\"primary\",onClick:login},\"Login\"))),/*#__PURE__*/React.createElement(Footer,null));};export default Login;","map":{"version":3,"names":["LockOutlined","UserOutlined","Button","Input","message","React","useState","useHistory","config","Footer","Header","Login","history","loading","setLoading","email","setEmail","password","setPassword","validateInput","error","validateResponse","errored","response","tokens","performAPICall","fetch","concat","endpoint","method","headers","body","JSON","stringify","json","e","persistLogin","token","balance","name","userId","localStorage","setItem","login","access","user","walletMoney","_id","success","push","createElement","Fragment","className","prefix","placeholder","value","onChange","target","Password","type","onClick"],"sources":["/Users/krunal/Desktop/Crio project/Fullstack/Flix-cart/Frontend/src/components/Login.js"],"sourcesContent":["import { LockOutlined, UserOutlined } from \"@ant-design/icons\";\nimport { Button, Input, message } from \"antd\";\nimport React, { useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { config } from \"../App\";\nimport Footer from \"./Footer\";\nimport Header from \"./Header\";\n\nconst Login = () => {\n  const history = useHistory();\n  const [loading, setLoading] = useState(false);\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  const validateInput = () => {\n    if (!email) {\n      message.error(\"Email is a required field\");\n      return false;\n    }\n    if (!password) {\n      message.error(\"Password is a required field\");\n      return false;\n    }\n    return true;\n  };\n\n  const validateResponse = (errored, response) => {\n    if (errored || (!response.tokens && !response.message)) {\n      message.error(\n        \"Something went wrong. Check that the backend is running, reachable and returns valid JSON.\"\n      );\n      return false;\n    }\n    if (!response.tokens) {\n      message.error(response.message);\n      return false;\n    }\n    return true;\n  };\n\n  const performAPICall = async () => {\n    let response = {};\n    let errored = false;\n    setLoading(true);\n    try {\n      response = await (\n        await fetch(`${config.endpoint}/auth/login`, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            email,\n            password,\n          }),\n        })\n      ).json();\n    } catch (e) {\n      errored = true;\n    }\n    setLoading(false);\n    if (validateResponse(errored, response)) {\n      return response;\n    }\n  };\n\n  const persistLogin = (token, email, balance, name, userId) => {\n    localStorage.setItem(\"token\", token);\n    localStorage.setItem(\"email\", email);\n    localStorage.setItem(\"balance\", balance);\n    localStorage.setItem(\"username\", name);\n    localStorage.setItem(\"userId\", userId);\n    localStorage.setItem(\"cartAmount\", null)\n  };\n\n  const login = async () => {\n    if (validateInput()) {\n      const response = await performAPICall();\n      if (response) {\n        persistLogin(\n          response.tokens.access.token,\n          response.user.email,\n          response.user.walletMoney,\n          response.user.name,\n          response.user._id\n        );\n        setEmail(\"\");\n        setPassword(\"\");\n        message.success(\"Logged in successfully\");\n        history.push(\"/products\");\n      }\n    }\n  };\n\n  return (\n    <>\n      {/* Display Header */}\n      <Header history={history} />\n\n      {/* Display Login fields */}\n      <div className=\"flex-container\">\n        <div className=\"login-container container\">\n          <h1>Login to FlixCart</h1>\n\n          <Input\n            className=\"input-field\"\n            prefix={<UserOutlined className=\"site-form-item-icon\" />}\n            placeholder=\"email\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n          />\n\n          <Input.Password\n            className=\"input-field\"\n            prefix={<LockOutlined className=\"site-form-item-icon\" />}\n            placeholder=\"Password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n\n          <Button loading={loading} type=\"primary\" onClick={login}>\n            Login\n          </Button>\n        </div>\n      </div>\n\n      {/* Display the footer */}\n      <Footer />\n    </>\n  );\n};\n\nexport default Login;\n"],"mappings":"AAAA,OAASA,YAAY,CAAEC,YAAY,KAAQ,mBAAmB,CAC9D,OAASC,MAAM,CAAEC,KAAK,CAAEC,OAAO,KAAQ,MAAM,CAC7C,MAAO,CAAAC,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,UAAU,KAAQ,kBAAkB,CAC7C,OAASC,MAAM,KAAQ,QAAQ,CAC/B,MAAO,CAAAC,MAAM,KAAM,UAAU,CAC7B,MAAO,CAAAC,MAAM,KAAM,UAAU,CAE7B,KAAM,CAAAC,KAAK,CAAGA,CAAA,GAAM,CAClB,KAAM,CAAAC,OAAO,CAAGL,UAAU,CAAC,CAAC,CAC5B,KAAM,CAACM,OAAO,CAAEC,UAAU,CAAC,CAAGR,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACS,KAAK,CAAEC,QAAQ,CAAC,CAAGV,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACW,QAAQ,CAAEC,WAAW,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CAE5C,KAAM,CAAAa,aAAa,CAAGA,CAAA,GAAM,CAC1B,GAAI,CAACJ,KAAK,CAAE,CACVX,OAAO,CAACgB,KAAK,CAAC,2BAA2B,CAAC,CAC1C,MAAO,MAAK,CACd,CACA,GAAI,CAACH,QAAQ,CAAE,CACbb,OAAO,CAACgB,KAAK,CAAC,8BAA8B,CAAC,CAC7C,MAAO,MAAK,CACd,CACA,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAC,gBAAgB,CAAGA,CAACC,OAAO,CAAEC,QAAQ,GAAK,CAC9C,GAAID,OAAO,EAAK,CAACC,QAAQ,CAACC,MAAM,EAAI,CAACD,QAAQ,CAACnB,OAAQ,CAAE,CACtDA,OAAO,CAACgB,KAAK,CACX,4FACF,CAAC,CACD,MAAO,MAAK,CACd,CACA,GAAI,CAACG,QAAQ,CAACC,MAAM,CAAE,CACpBpB,OAAO,CAACgB,KAAK,CAACG,QAAQ,CAACnB,OAAO,CAAC,CAC/B,MAAO,MAAK,CACd,CACA,MAAO,KAAI,CACb,CAAC,CAED,KAAM,CAAAqB,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CAAAF,QAAQ,CAAG,CAAC,CAAC,CACjB,GAAI,CAAAD,OAAO,CAAG,KAAK,CACnBR,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CACFS,QAAQ,CAAG,KAAM,CACf,KAAM,CAAAG,KAAK,IAAAC,MAAA,CAAInB,MAAM,CAACoB,QAAQ,gBAAe,CAC3CC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBlB,KAAK,CACLE,QACF,CAAC,CACH,CAAC,CAAC,EACFiB,IAAI,CAAC,CAAC,CACV,CAAE,MAAOC,CAAC,CAAE,CACVb,OAAO,CAAG,IAAI,CAChB,CACAR,UAAU,CAAC,KAAK,CAAC,CACjB,GAAIO,gBAAgB,CAACC,OAAO,CAAEC,QAAQ,CAAC,CAAE,CACvC,MAAO,CAAAA,QAAQ,CACjB,CACF,CAAC,CAED,KAAM,CAAAa,YAAY,CAAGA,CAACC,KAAK,CAAEtB,KAAK,CAAEuB,OAAO,CAAEC,IAAI,CAAEC,MAAM,GAAK,CAC5DC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEL,KAAK,CAAC,CACpCI,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE3B,KAAK,CAAC,CACpC0B,YAAY,CAACC,OAAO,CAAC,SAAS,CAAEJ,OAAO,CAAC,CACxCG,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEH,IAAI,CAAC,CACtCE,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAEF,MAAM,CAAC,CACtCC,YAAY,CAACC,OAAO,CAAC,YAAY,CAAE,IAAI,CAAC,CAC1C,CAAC,CAED,KAAM,CAAAC,KAAK,CAAG,KAAAA,CAAA,GAAY,CACxB,GAAIxB,aAAa,CAAC,CAAC,CAAE,CACnB,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAE,cAAc,CAAC,CAAC,CACvC,GAAIF,QAAQ,CAAE,CACZa,YAAY,CACVb,QAAQ,CAACC,MAAM,CAACoB,MAAM,CAACP,KAAK,CAC5Bd,QAAQ,CAACsB,IAAI,CAAC9B,KAAK,CACnBQ,QAAQ,CAACsB,IAAI,CAACC,WAAW,CACzBvB,QAAQ,CAACsB,IAAI,CAACN,IAAI,CAClBhB,QAAQ,CAACsB,IAAI,CAACE,GAChB,CAAC,CACD/B,QAAQ,CAAC,EAAE,CAAC,CACZE,WAAW,CAAC,EAAE,CAAC,CACfd,OAAO,CAAC4C,OAAO,CAAC,wBAAwB,CAAC,CACzCpC,OAAO,CAACqC,IAAI,CAAC,WAAW,CAAC,CAC3B,CACF,CACF,CAAC,CAED,mBACE5C,KAAA,CAAA6C,aAAA,CAAA7C,KAAA,CAAA8C,QAAA,mBAEE9C,KAAA,CAAA6C,aAAA,CAACxC,MAAM,EAACE,OAAO,CAAEA,OAAQ,CAAE,CAAC,cAG5BP,KAAA,CAAA6C,aAAA,QAAKE,SAAS,CAAC,gBAAgB,eAC7B/C,KAAA,CAAA6C,aAAA,QAAKE,SAAS,CAAC,2BAA2B,eACxC/C,KAAA,CAAA6C,aAAA,WAAI,mBAAqB,CAAC,cAE1B7C,KAAA,CAAA6C,aAAA,CAAC/C,KAAK,EACJiD,SAAS,CAAC,aAAa,CACvBC,MAAM,cAAEhD,KAAA,CAAA6C,aAAA,CAACjD,YAAY,EAACmD,SAAS,CAAC,qBAAqB,CAAE,CAAE,CACzDE,WAAW,CAAC,OAAO,CACnBC,KAAK,CAAExC,KAAM,CACbyC,QAAQ,CAAGrB,CAAC,EAAKnB,QAAQ,CAACmB,CAAC,CAACsB,MAAM,CAACF,KAAK,CAAE,CAC3C,CAAC,cAEFlD,KAAA,CAAA6C,aAAA,CAAC/C,KAAK,CAACuD,QAAQ,EACbN,SAAS,CAAC,aAAa,CACvBC,MAAM,cAAEhD,KAAA,CAAA6C,aAAA,CAAClD,YAAY,EAACoD,SAAS,CAAC,qBAAqB,CAAE,CAAE,CACzDE,WAAW,CAAC,UAAU,CACtBC,KAAK,CAAEtC,QAAS,CAChBuC,QAAQ,CAAGrB,CAAC,EAAKjB,WAAW,CAACiB,CAAC,CAACsB,MAAM,CAACF,KAAK,CAAE,CAC9C,CAAC,cAEFlD,KAAA,CAAA6C,aAAA,CAAChD,MAAM,EAACW,OAAO,CAAEA,OAAQ,CAAC8C,IAAI,CAAC,SAAS,CAACC,OAAO,CAAEjB,KAAM,EAAC,OAEjD,CACL,CACF,CAAC,cAGNtC,KAAA,CAAA6C,aAAA,CAACzC,MAAM,KAAE,CACT,CAAC,CAEP,CAAC,CAED,cAAe,CAAAE,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module"}